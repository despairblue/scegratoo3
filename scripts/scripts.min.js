"use strict";angular.module("scegratooApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap"]).config(function(e){e.when("/",{redirectTo:"/projects"}).when("/projects",{templateUrl:"views/projects.html",controller:"ProjectsCtrl"}).when("/projects/:project",{templateUrl:"views/project.html",controller:"ProjectCtrl"}).when("/projects/:project/x3d/:file*",{templateUrl:"views/projects/:project/x3d/:file.html",controller:"ProjectsProjectX3dFileCtrl"})});var bootstrap=function(){angular.element(document).ready(function(){angular.bootstrap(document,["scegratooApp"])})};window.__karma__?bootstrap():(traceur.options.experimental=!0,new traceur.WebPageTranscoder(document.location.href).run(function(){bootstrap()})),angular.module("scegratooApp").controller("MainCtrl",function(e,t){e.catalog=t}),angular.module("scegratooApp").controller("ProjectCtrl",function(e,t,n){e.project=n.get({project:t.project},function(n){e.projectName=t.project,n.files.forEach(function(e,t,n){n[t]={path:e,view:""}}),n.files.forEach(function(e){var t=e.path.match(/.[^.]*$/)[0];switch(t){case".js":e.view="source";break;case".x3d":e.view="x3d";break;case".sdf":e.view="ssiml"}})})}),angular.module("scegratooApp").controller("ProjectsCtrl",function(e,t){e.projects=t.query()}),angular.module("scegratooApp").directive("sgtNavigationBar",function(){return{templateUrl:"views/directives/sgt-navigation-bar.html",restrict:"AE",scope:!0,link:function(e,t){e.items=[{text:"X3D",href:"x3d"},{text:"Source",href:"source"},{text:"Tree",href:"tree"},{text:"Ssiml",href:"ssiml"}],t.addClass("navbar navbar-default navbar-fixed-top"),t.attr("role","navigation")}}}),angular.module("scegratooApp").directive("sgtX3d",function(e,t,n,r,o,a,i){return{restrict:"AE",link:function(t,n,l){var c=["templates/crosshair.html","templates/planeSensor-X.html","templates/planeSensor-Y.html"],s=[];angular.forEach(c,function(e){s.push(o.get(e,{cache:i}))}),a.all(s).then(function(e){angular.forEach(e,function(e){i.put(e.config.url,e.data)})}).then(function(){var o=new e.dat.GUI({autoPlace:!1});console.debug("Created ",o),n.parent().prepend($(o.domElement).css("float","left").css("position","absolute").css("z-index",1));var a=o.addFolder("Coordinates"),i=o.addFolder("Switches"),c=r.setUp(n);a.add(c,"x").listen(),a.add(c,"y").listen(),a.add(c,"z").listen(),i.add(c,"useHitPnt"),i.add(c,"snapToGrid"),t.$watch(l.content,function(e){n.html(e),n.children().addClass("fullpage"),c=r.setUp(n)})})}}}),angular.module("scegratooApp").value("catalog",[{id:1,name:"Batarang",img:"images/yeoman.png",price:80},{id:2,name:"Utility Belt",img:"images/yeoman.png",price:120}]),angular.module("scegratooApp").value("Constants",{apiRoot:"api/v1"}),angular.module("scegratooApp").service("Project",function(e,t,n){var r=n.apiRoot+"/projects/:project.:format",o=e(r,{format:"json"});return{get:function(t,r){if(t.file){var a=[n.apiRoot,"projects",encodeURI(t.project),encodeURI(t.file)].join("/"),i=e(a,{},{get:{method:"GET",transformResponse:function(e){return{data:e}}}});return i.get(r)}return o.get(t,r)},query:o.query}}),angular.module("scegratooApp").service("X3dWidgets",function(){var e=function(){},t=function(){};return{createCrosshair:e,createPlane:t}}),angular.module("scegratooApp").service("X3domUtils",function(e,t,n,r){var o,a,i,l,c={x:0,y:0,z:0},s={useHitPnt:!1,snapToGrid:!1,x:"",y:"",z:""},u=function(t){for(var n=document.querySelector("X3D").runtime,r="",o=t.hitObject,i=t.hitObject;"scene"!==i.nodeName.toLowerCase();)i=i.parentNode,"inline"===i.nodeName.toLowerCase()&&(o=i);c=s.useHitPnt?new e.x3dom.fields.SFVec3f(t.hitPnt[0],t.hitPnt[1],t.hitPnt[2]):n.getCenter(o),o.parentNode.appendChild(a),r=c.x+" "+c.y+" "+c.z,a.setAttribute("translation",r)},d=function(){},p=function(){a.parentNode&&a.parentNode.removeChild(a)},g=function(t){var n,r;"translation_changed"===t.fieldName&&(n=e.x3dom.fields.SFMatrix4f.parseRotation(t.target.getAttribute("axisRotation")),r=n.multMatrixVec(t.value),s.snapToGrid&&(r.x=Math.floor(r.x)),angular.forEach(o,function(e){var t=e.parentNode.getFieldValue("translation");t.x=r.x,e.parentNode.setFieldValue("translation",t)}))},f=function(t){var n,r;"translation_changed"===t.fieldName&&(n=e.x3dom.fields.SFMatrix4f.parseRotation(t.target.getAttribute("axisRotation")),r=n.multMatrixVec(t.value),s.snapToGrid&&(r.y=Math.floor(r.y)),angular.forEach(o,function(e){var t=e.parentNode.getFieldValue("translation");t.y=r.y,e.parentNode.setFieldValue("translation",t)}))},m=function(c){var m=0;return console.debug("Set up scene."),a=angular.element(n.get("templates/crosshair.html")).get(0),i=angular.element(n.get("templates/planeSensor-X.html")).get(0),l=angular.element(n.get("templates/planeSensor-Y.html")).get(0),o=c.find("inline"),angular.forEach(o,function(e){var n=e.getAttribute("url");e.setAttribute("url",r.apiRoot+"/projects/"+t.project+"/"+t.file.replace(/\/[^\/]*$/,"")+"/"+n)}),e.x3dom.reload(),angular.forEach(c.find("scene"),function(e){e.appendChild(i),e.appendChild(l)}),angular.forEach(o,function(t){t.addEventListener("mousedown",u),t.addEventListener("mouseup",p),t.addEventListener("load",function(){m+=1,m===o.length&&c.children().get(0)&&c.children().get(0).runtime&&(window.x3dNode=c.children().get(0),c.children().get(0).runtime.showAll())}),new e.x3dom.Moveable(c.children().get(0),t.parentElement,d,0,"all")}),i.children[0].addEventListener("onoutputchange",g),l.children[0].addEventListener("onoutputchange",f),s};return{setUp:m}}),angular.module("scegratooApp").controller("ProjectsProjectX3dFileCtrl",function(e,t,n){n.get({project:t.project,file:t.file},function(t){e.x3d=t.data})});